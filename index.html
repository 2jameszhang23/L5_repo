<!DOCTYPE html>
<html>
<head>
    <title>📂 文件浏览器</title>
    <script>
        async function loadFiles(path="") {
            const repo = "2jameszhang23/L5_repo";
            const apiUrl = `https://api.github.com/repos/${repo}/contents/${path}`;

            let response = await fetch(apiUrl);
            if (!response.ok) {
                document.getElementById("file-list").innerHTML = "<p>❌ 读取失败！</p>";
                return;
            }
            let files = await response.json();

            let list = document.getElementById("file-list");
            list.innerHTML = "";

            files.forEach(file => {
                let item = document.createElement("li");
                let link = document.createElement("a");
                link.textContent = file.name;
                
                if (file.type === "dir") {
                    link.href = `?path=${file.path}`;
                } else {
                    link.href = file.download_url;
                }

                item.appendChild(link);
                list.appendChild(item);
            });
        }

        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const path = urlParams.get('path') || "";
            loadFiles(path);
        };
    </script>
</head>
<body>
    <h1>📂 文件浏览器</h1>
    <ul id="file-list">加载中...</ul>
</body>
</html>
